# ğŸ“¹ å½±ç‰‡å£“ç¸®è…³æœ¬ä½¿ç”¨æŒ‡å—

## ğŸ¯ è…³æœ¬åŠŸèƒ½

`compress-videos.ps1` æ˜¯ä¸€å€‹è‡ªå‹•åŒ–å½±ç‰‡å£“ç¸®å·¥å…·ï¼Œå¯ä»¥ï¼š
- è‡ªå‹•æ‰¾åˆ°å°ˆæ¡ˆä¸­çš„æ‰€æœ‰ `.mp4` å½±ç‰‡
- æä¾› 3 ç¨®å£“ç¸®æ–¹æ¡ˆ
- è‡ªå‹•å£“ç¸®ä¸¦é¡¯ç¤ºå£“ç¸®ç‡
- ä¿è­·åŸå§‹æª”æ¡ˆï¼ˆä¸æœƒç›´æ¥è¦†è“‹ï¼‰

## ğŸ“‹ å‰ç½®éœ€æ±‚

### 1. ç¢ºèªå·²å®‰è£ FFmpeg
```bash
# æª¢æŸ¥æ˜¯å¦å·²å®‰è£ FFmpeg
ffmpeg -version
```

å¦‚æœæ²’æœ‰å®‰è£ï¼Œè«‹å‰å¾€ï¼šhttps://ffmpeg.org/download.html

### 2. ç¢ºèªå°ˆæ¡ˆä¸­æœ‰å½±ç‰‡æª”æ¡ˆ
å½±ç‰‡æ‡‰è©²æ”¾åœ¨ï¼š`public/assets/videos/` è³‡æ–™å¤¾ä¸­

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### æ–¹æ³• 1: ä½¿ç”¨é è¨­è¨­å®šï¼ˆæ¨è–¦ï¼‰

**æœ€ç°¡å–®çš„ä½¿ç”¨æ–¹å¼ï¼Œä½¿ç”¨æ¨™æº–å£“ç¸®ï¼ˆ720pï¼‰**

```powershell
# åœ¨å°ˆæ¡ˆæ ¹ç›®éŒ„åŸ·è¡Œ
.\compress-videos.ps1
```

é€™æœƒä½¿ç”¨**æ–¹æ¡ˆ 1ï¼ˆæ¨™æº–å£“ç¸®ï¼‰**ï¼š
- è§£æåº¦ï¼š1280x720 (HD)
- ä½å…ƒç‡ï¼š2.5 Mbps
- å“è³ªï¼šé©åˆå¤§å¤šæ•¸ç¶²ç«™ä½¿ç”¨
- å£“ç¸®ç‡ï¼šç´„ 90%

### æ–¹æ³• 2: æŒ‡å®šå£“ç¸®æ–¹æ¡ˆ

```powershell
# æ–¹æ¡ˆ 1ï¼šæ¨™æº–å£“ç¸®ï¼ˆæ¨è–¦ï¼‰
.\compress-videos.ps1 -mode 1

# æ–¹æ¡ˆ 2ï¼šé«˜åº¦å£“ç¸®ï¼ˆæœ€å°æª”æ¡ˆï¼‰
.\compress-videos.ps1 -mode 2

# æ–¹æ¡ˆ 3ï¼šWebM æ ¼å¼ï¼ˆæœ€ä½³ç¶²è·¯æ•ˆèƒ½ï¼‰
.\compress-videos.ps1 -mode 3
```

## ğŸ“Š ä¸‰ç¨®å£“ç¸®æ–¹æ¡ˆæ¯”è¼ƒ

| æ–¹æ¡ˆ | è§£æåº¦ | ä½å…ƒç‡ | æª”æ¡ˆæ ¼å¼ | é©ç”¨æƒ…å¢ƒ | é æœŸæª”æ¡ˆå¤§å° |
|------|--------|--------|----------|----------|-------------|
| **æ–¹æ¡ˆ 1** | 1280x720 | 2.5 Mbps | MP4 (H.264) | **å¤§å¤šæ•¸ç¶²ç«™** | ~6-7 MB/åˆ†é˜ |
| **æ–¹æ¡ˆ 2** | 854x480 | 1.5 Mbps | MP4 (H.264) | æ‰‹æ©Ÿå„ªå…ˆã€ä½æµé‡ | ~4-5 MB/åˆ†é˜ |
| **æ–¹æ¡ˆ 3** | 1280x720 | 2.0 Mbps | WebM (VP9) | ç¾ä»£ç€è¦½å™¨ã€æœ€ä½³å£“ç¸® | ~5-6 MB/åˆ†é˜ |

### å¦‚ä½•é¸æ“‡ï¼Ÿ

- **ä¸ç¢ºå®šé¸å“ªå€‹ï¼Ÿ** â†’ ä½¿ç”¨**æ–¹æ¡ˆ 1**ï¼ˆå·²ç¶“å¾ˆå¥½äº†ï¼‰
- **éœ€è¦è¶…å°æª”æ¡ˆï¼Ÿ** â†’ ä½¿ç”¨**æ–¹æ¡ˆ 2**ï¼ˆä½†ç•«è³ªæœƒé™ä½ï¼‰
- **åªæ”¯æ´ç¾ä»£ç€è¦½å™¨ï¼Ÿ** â†’ ä½¿ç”¨**æ–¹æ¡ˆ 3**ï¼ˆå£“ç¸®ç‡æ›´å¥½ï¼‰

## ğŸ¬ å®Œæ•´æ“ä½œæµç¨‹

### æ­¥é©Ÿ 1: é–‹å•Ÿ PowerShell

```powershell
# æ–¹æ³• 1: åœ¨å°ˆæ¡ˆè³‡æ–™å¤¾ä¸­ï¼ŒæŒ‰ä½ Shift + å³éµ â†’ é¸æ“‡ã€Œåœ¨æ­¤è™•é–‹å•Ÿ PowerShell è¦–çª—ã€

# æ–¹æ³• 2: æ‰‹å‹•åˆ‡æ›åˆ°å°ˆæ¡ˆç›®éŒ„
cd D:\frontend\dtmrs-website
```

### æ­¥é©Ÿ 2: åŸ·è¡Œå£“ç¸®è…³æœ¬

```powershell
# ä½¿ç”¨é è¨­è¨­å®šï¼ˆæ¨è–¦ï¼‰
.\compress-videos.ps1
```

### æ­¥é©Ÿ 3: ç­‰å¾…å£“ç¸®å®Œæˆ

ä½ æœƒçœ‹åˆ°é¡ä¼¼é€™æ¨£çš„è¼¸å‡ºï¼š

```
================================================
  Video Compression Tool
================================================

Found 3 video files
Compression mode: 1

Processing: æˆ‘çš„å½±ç‰‡.mp4
Original size: 70.22 MB
Settings: 1280x720, 2.5Mbps, H.264
SUCCESS!
   Compressed size: 6.81 MB
   Compression ratio: 90.3%
   Output: public\assets\videos\compressed\æˆ‘çš„å½±ç‰‡-720p.mp4

...

================================================
  Compression Complete!
================================================
```

### æ­¥é©Ÿ 4: æª¢æŸ¥å£“ç¸®çµæœ

å£“ç¸®å¾Œçš„å½±ç‰‡æœƒæ”¾åœ¨ï¼š
```
public/assets/videos/compressed/
â”œâ”€â”€ å½±ç‰‡1-720p.mp4
â”œâ”€â”€ å½±ç‰‡2-720p.mp4
â””â”€â”€ å½±ç‰‡3-720p.mp4
```

### æ­¥é©Ÿ 5: æ¸¬è©¦å½±ç‰‡å“è³ª

**é‡è¦ï¼åœ¨æ›¿æ›åŸå§‹æª”æ¡ˆå‰ï¼Œä¸€å®šè¦å…ˆæ¸¬è©¦å“è³ª**

1. ç”¨å½±ç‰‡æ’­æ”¾å™¨æ‰“é–‹å£“ç¸®å¾Œçš„å½±ç‰‡
2. æª¢æŸ¥ç•«é¢æ˜¯å¦æ¸…æ™°
3. æª¢æŸ¥éŸ³è¨Šæ˜¯å¦æ­£å¸¸
4. ç¢ºèªå¯ä»¥æ¥å—å†ç¹¼çºŒ

### æ­¥é©Ÿ 6: æ›¿æ›åŸå§‹å½±ç‰‡ï¼ˆå¦‚æœæ»¿æ„ï¼‰

```powershell
# å‚™ä»½åŸå§‹å½±ç‰‡ï¼ˆé‡è¦ï¼ï¼‰
Move-Item -Path "public/assets/videos/*.mp4" -Destination "public/assets/videos/backup-original/" -Force

# ç§»å‹•å£“ç¸®å¾Œçš„å½±ç‰‡ä¸¦é‡æ–°å‘½åï¼ˆç§»é™¤ -720p å¾Œç¶´ï¼‰
cd public/assets/videos/compressed
Get-ChildItem *.mp4 | ForEach-Object {
    $newName = $_.Name -replace '-720p', ''
    Move-Item $_.FullName -Destination "..\$newName" -Force
}
cd ..\..\..

# åˆªé™¤ compressed è³‡æ–™å¤¾
Remove-Item -Path "public/assets/videos/compressed" -Recurse
```

### æ­¥é©Ÿ 7: æ¸¬è©¦ç¶²ç«™

```bash
# å•Ÿå‹•é–‹ç™¼ä¼ºæœå™¨
npm run dev

# æª¢æŸ¥ç¶²ç«™ä¸­çš„å½±ç‰‡æ˜¯å¦æ­£å¸¸æ’­æ”¾
```

## ğŸ”§ å¸¸è¦‹å•é¡Œ

### Q1: åŸ·è¡Œè…³æœ¬æ™‚å‡ºç¾ã€Œç„¡æ³•åŸ·è¡Œã€éŒ¯èª¤ï¼Ÿ

**éŒ¯èª¤è¨Šæ¯**:
```
.\compress-videos.ps1 : ç„¡æ³•è¼‰å…¥æª”æ¡ˆï¼Œå› ç‚ºé€™å€‹ç³»çµ±å·²åœç”¨æŒ‡ä»¤ç¢¼åŸ·è¡Œ...
```

**è§£æ±ºæ–¹æ¡ˆ**:
```powershell
# è‡¨æ™‚å…è¨±åŸ·è¡Œè…³æœ¬ï¼ˆæ¨è–¦ï¼‰
powershell -ExecutionPolicy Bypass -File compress-videos.ps1

# æˆ–æ°¸ä¹…å…è¨±ï¼ˆä¸æ¨è–¦ï¼Œé™¤éä½ çŸ¥é“åœ¨åšä»€éº¼ï¼‰
Set-ExecutionPolicy RemoteSigned -Scope CurrentUser
```

### Q2: æ‰¾ä¸åˆ° FFmpegï¼Ÿ

**éŒ¯èª¤è¨Šæ¯**:
```
ffmpeg : ç„¡æ³•è¾¨è­˜ 'ffmpeg' è©å½™æ˜¯å¦ç‚º Cmdletã€å‡½æ•¸ã€æŒ‡ä»¤æª”...
```

**è§£æ±ºæ–¹æ¡ˆ**:
1. ä¸‹è¼‰ FFmpeg: https://ffmpeg.org/download.html
2. è§£å£“ç¸®ä¸¦å°‡ `ffmpeg.exe` è·¯å¾‘åŠ å…¥ç³»çµ±ç’°å¢ƒè®Šæ•¸
3. é‡æ–°é–‹å•Ÿ PowerShell

### Q3: å£“ç¸®å¾Œçš„å½±ç‰‡åœ¨å“ªè£¡ï¼Ÿ

å£“ç¸®å¾Œçš„å½±ç‰‡æœƒè‡ªå‹•å­˜æ”¾åœ¨ï¼š
```
public/assets/videos/compressed/
```

åŸå§‹å½±ç‰‡**ä¸æœƒè¢«ä¿®æ”¹**ï¼Œä½ å¯ä»¥å®‰å…¨åœ°æ¸¬è©¦å£“ç¸®æ•ˆæœã€‚

### Q4: å¦‚ä½•æ¢å¾©åŸå§‹å½±ç‰‡ï¼Ÿ

å¦‚æœå·²ç¶“æ›¿æ›äº†åŸå§‹å½±ç‰‡ï¼Œå¯ä»¥å¾å‚™ä»½æ¢å¾©ï¼š

```powershell
# åˆªé™¤å£“ç¸®ç‰ˆæœ¬
Remove-Item public/assets/videos/*.mp4

# æ¢å¾©åŸå§‹å½±ç‰‡
Move-Item -Path "public/assets/videos/backup-original/*.mp4" -Destination "public/assets/videos/" -Force
```

### Q5: å¯ä»¥å£“ç¸®å…¶ä»–æ ¼å¼çš„å½±ç‰‡å—ï¼Ÿ

ç›®å‰è…³æœ¬åªæ”¯æ´ `.mp4` æª”æ¡ˆã€‚å¦‚æœä½ æœ‰å…¶ä»–æ ¼å¼ï¼ˆå¦‚ `.avi`, `.mov`, `.mkv`ï¼‰ï¼Œå¯ä»¥ï¼š

1. **ä¿®æ”¹è…³æœ¬**:
   ```powershell
   # æ‰¾åˆ°é€™ä¸€è¡Œï¼ˆç¬¬ 22 è¡Œï¼‰
   $videos = Get-ChildItem -Path $inputDir -Filter "*.mp4"

   # æ”¹æˆæ”¯æ´å¤šç¨®æ ¼å¼
   $videos = Get-ChildItem -Path $inputDir -Include "*.mp4","*.avi","*.mov","*.mkv" -Recurse
   ```

2. **æˆ–å…ˆç”¨ FFmpeg è½‰æ›**:
   ```bash
   ffmpeg -i input.avi output.mp4
   ```

### Q6: å£“ç¸®éœ€è¦å¤šä¹…æ™‚é–“ï¼Ÿ

å–æ±ºæ–¼ï¼š
- å½±ç‰‡é•·åº¦ï¼ˆ1 åˆ†é˜å½±ç‰‡ç´„éœ€ 20-30 ç§’ï¼‰
- å½±ç‰‡æ•¸é‡ï¼ˆ3 å€‹å½±ç‰‡ç´„ 1-2 åˆ†é˜ï¼‰
- é›»è…¦æ•ˆèƒ½ï¼ˆCPU è¶Šå¿«è¶Šå¥½ï¼‰
- å£“ç¸®æ–¹æ¡ˆï¼ˆ`-preset slow` è¼ƒæ…¢ä½†å“è³ªæ›´å¥½ï¼‰

**é ä¼°æ™‚é–“**:
- 1 åˆ†é˜å½±ç‰‡ = 20-30 ç§’å£“ç¸®æ™‚é–“
- ä½ çš„ 3 å€‹ 60 ç§’å½±ç‰‡ = ç´„ 1-2 åˆ†é˜

## ğŸ’¡ é€²éšæŠ€å·§

### è‡ªè¨‚å£“ç¸®è¨­å®š

å¦‚æœä½ æƒ³è‡ªè¨‚å£“ç¸®åƒæ•¸ï¼Œå¯ä»¥ç›´æ¥ä¿®æ”¹ `compress-videos.ps1` ä¸­çš„è¨­å®šï¼š

```powershell
# æ‰¾åˆ°æ–¹æ¡ˆ 1 çš„è¨­å®šï¼ˆç¬¬ 40-56 è¡Œï¼‰
& ffmpeg -i $inputFile `
    -vf "scale=1280:720" `      # ä¿®æ”¹è§£æåº¦
    -b:v 2.5M `                  # ä¿®æ”¹ä½å…ƒç‡
    -crf 23 `                    # ä¿®æ”¹å“è³ªï¼ˆ18-28ï¼Œæ•¸å­—è¶Šå°å“è³ªè¶Šå¥½ï¼‰
    ...
```

### æ‰¹æ¬¡è™•ç†å¤šå€‹è³‡æ–™å¤¾

```powershell
# è™•ç†å¤šå€‹è³‡æ–™å¤¾ä¸­çš„å½±ç‰‡
$folders = @(
    "public/assets/videos",
    "public/assets/demos",
    "public/assets/tutorials"
)

foreach ($folder in $folders) {
    .\compress-videos.ps1 -inputDir $folder
}
```

### åªå£“ç¸®å¤§æ–¼æŒ‡å®šå¤§å°çš„å½±ç‰‡

åœ¨è…³æœ¬ä¸­åŠ å…¥æª”æ¡ˆå¤§å°æª¢æŸ¥ï¼š

```powershell
# åªå£“ç¸®å¤§æ–¼ 50MB çš„å½±ç‰‡
foreach ($video in $videos) {
    if ($video.Length -gt 50MB) {
        # åŸ·è¡Œå£“ç¸®...
    } else {
        Write-Host "è·³é: $($video.Name) (å°æ–¼ 50MB)" -ForegroundColor Yellow
    }
}
```

## ğŸ“š å»¶ä¼¸é–±è®€

- [FFmpeg å®˜æ–¹æ–‡æª”](https://ffmpeg.org/documentation.html)
- [H.264 ç·¨ç¢¼æŒ‡å—](https://trac.ffmpeg.org/wiki/Encode/H.264)
- [å½±ç‰‡å£“ç¸®çµæœå ±å‘Š](./VIDEO_COMPRESSION_RESULT.md)

## ğŸ¯ å¿«é€Ÿåƒè€ƒ

```powershell
# åŸºæœ¬ä½¿ç”¨
.\compress-videos.ps1                    # ä½¿ç”¨é è¨­è¨­å®šï¼ˆæ¨è–¦ï¼‰

# é¸æ“‡æ–¹æ¡ˆ
.\compress-videos.ps1 -mode 1           # æ¨™æº–å£“ç¸®ï¼ˆæ¨è–¦ï¼‰
.\compress-videos.ps1 -mode 2           # é«˜åº¦å£“ç¸®
.\compress-videos.ps1 -mode 3           # WebM æ ¼å¼

# æ›¿æ›åŸå§‹æª”æ¡ˆï¼ˆæ¸¬è©¦æ»¿æ„å¾Œï¼‰
Move-Item "public/assets/videos/compressed/*" "public/assets/videos/" -Force

# æ¢å¾©åŸå§‹æª”æ¡ˆ
Move-Item "public/assets/videos/backup-original/*" "public/assets/videos/" -Force
```

---

**å»ºç«‹æ—¥æœŸ**: 2025-12-17
**é©ç”¨å°ˆæ¡ˆ**: dtmrs-website
**è…³æœ¬ç‰ˆæœ¬**: 1.0
